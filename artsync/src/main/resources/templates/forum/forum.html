<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/JSP_Servlet/Html.html to edit this template
-->
<html  xmlns:th="http://www.thymeleaf.org" lang="">
    <head>
        <title>ArtSync</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}"/>
        <link rel="stylesheet" type="text/css" th:href="@{/css/style-forum.css}"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r126/three.min.js" integrity="sha512-n8IpKWzDnBOcBhRlHirMZOUvEq2bLRMuJGjuVqbzUJwtTsgwOgK5aS0c1JA647XWYfqvXve8k3PtZdzpipFjgg==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.9/dat.gui.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/TextPlugin.min.js"></script>
    </head>

    <body class="body-content">

    <!--Header-->
    <nav th:replace="${session.user == null} ? ~{fragment/fragments :: headerFragment} : ~{fragment/fragments :: headerUserFragment}"></nav>

    <!--Content-->
    <div class="content">
        <div class="verticalHeader">
            <h4 th:if="${session.user != null}">OPTIONS</h4>
            <hr th:if="${session.user != null}">
            <div th:if="${session.user != null}" class="sectionsHolder">
                <div class="section">
                    <i class="bi bi-chat-right-text"></i> <p>Vos Threads</p>
                </div>
                <div class="section">
                    <i class="bi bi-person-vcard"></i> <p>Threads de vos abonnements</p>
                </div>
                <div class="section">
                    <i class="bi bi-bookmark-check"></i> <p>Threads enregistrés</p>
                </div>
                <dialog id="creationDialog">
                    <div class="dialogHeader">
                        <h4>Créer un thread</h4>
                        <i class="bi bi-x-lg" id="closeDialog"></i>
                    </div>
                    <div class="formHolder">
                        <form class="form" th:object="${forum}" th:action="@{/forum/create}" method="POST" enctype="multipart/form-data">
                            
                            <label for="titre">Titre</label>
                            <div style="height: 5%; width: 100%" class="d-flex">
                                <input id="titreInput" type="text" name="titre" th:field="*{titre}">
                                <div class="d-flex" style="height: 5% ;width: 10%">

                                    <input name="fichier" id="fileButton" class="custom-file-label" type="file" style="opacity: 0" accept=".jpg,.png,.webp,.gif">
                                </div>

                            </div>
                            <label style="margin-top: 2%"  for="contenu">Contenu</label>
                            <textarea name="contenu"></textarea>
                            <div class="filterHolder">
                                <div>
                                    <input type="checkbox" checked name="tag" value="CONSEIL"><label for="" class="tag" id="conseil">CONSEIL</label>
                                </div>
                                <div>
                                    <input type="checkbox" name="tag" value="QUESTION"><label for="" class="tag"  id="question">QUESTION</label>
                                </div>
                                <div>
                                    <input type="checkbox"  name="tag" value="ANNONCE"><label for="" class="tag" id="annonce">ANNONCE</label>
                                </div>
                                <div>
                                    <input type="checkbox"  name="tag" value="INSPIRAION"><label for="" class="tag" id="inspiration">INSPIRAION</label>
                                </div>
                                <div>
                                    <input type="checkbox" name="tag" value="FEEDBACK"><label for="" class="tag" id="feedback">FEEDBACK</label>
                                </div>
                                <div>
                                    <input type="checkbox" name="tag" value="PROJET"><label for="" class="tag" id="projet">PROJET</label>
                                </div>
                            </div>
                            <div id="radioBtn">
                                <input type="radio" name="publique"> <label style="margin-right: 155%" for="publique">Public</label>
                            </div>
                            <button type="submit">
                                PUBLIER
                            </button>

                        </form>
                    </div>
                </dialog>
                <div class="section" id="openDialog">
                    <i class="bi bi-plus-square"></i> <p>Créer un thread</p>
                </div>
            </div>
            <h4>FILTRES</h4>
            <hr>
            <div class="sectionFilter">
                <form action="" class="filterForm">
                    <div>
                        <input class="form-check-input" type="checkbox" value="TEST"><label for="" class="tag" id="conseil">CONSEIL</label>
                    </div>
                    <div>
                        <input class="form-check-input" type="checkbox" value="TEST"><label for="" class="tag" id="question">QUESTION</label>
                    </div>
                    <div>
                        <input class="form-check-input" type="checkbox" value="TEST"><label for="" class="tag" id="annonce">ANNONCE</label>
                    </div>
                    <div>
                        <input class="form-check-input" type="checkbox" value="TEST"><label for="" class="tag" id="inspiration">INSPIRAION</label>
                    </div>
                    <div>
                        <input class="form-check-input" type="checkbox" value="TEST"><label for="" class="tag" id="feedback">FEEDBACK</label>
                    </div>
                    <div>
                        <input class="form-check-input" type="checkbox" value="TEST"><label for="" class="tag" id="projet">PROJET</label>
                    </div>
                </form>
            </div>
        </div>

        <div class="forumContent">
            <h3>FORUMS</h3>
            <hr>
            <div class="rechercheContainer">
                <form action="/search" method="get" class="rechercheForm">
                    <input type="text" name="searchTerm" placeholder="Rechercher un thread">
                    <button type="submit">Rechercher</button>
                </form>
            </div>

            <div class="resultHolder">
                <div th:each="thread : ${threads}" class="forumHolder">
                    <div class="threadHeader">
                        <p>[[${thread.titre}]]</p>
                    </div>
                    <div class="threadInfo">
                        <div class="threadUserPfp">
                            <img th:src="@{/media/images/{image}(image=${thread.utilisateur.getPhotoUrl()})}" alt="">
                        </div>
                        <div class="threadUserInfo">
                            <p><b>@[[${thread.utilisateur.pseudo}]]</b></p>
                            <p>Artiste [[${thread.utilisateur.specialisation}]]</p>
                            <p><small>[[${thread.dateCreation.toLocalDate()}]]</small></p>
                        </div>
                        <div class="threadTags">
                            <th:block th:each="tag : ${thread.getTags()}">
                                <p th:text="${tag}" class="tag" th:id="${tag}"></p>
                            </th:block>
                        </div>
                    </div>
                    <div class="threadContent">
                        <p>
                            [[${thread.contenu}]]
                        </p>
                    </div>
                    <div class="threadOptions">
                        <p class="chatThread"><i class="bi bi-bookmark"></i></p>
                        <p class="chatThread"><i class="bi bi-chat"></i> Ajouter une réponse</p>
                    </div>
                </div>


            </div>
        </div>
        <div class="filterContent">
            <div class="notificationHolder">
                <h4>NOTIFICATIONS </h4>
                <div class="notifcationContainer">
                    <h5>VOUS N'AVEZ AUCUNE NOTIFICATION</h5>
                </div>
            </div>
        </div>
    </div>
    </body>
    <script>
        const openDialog = document.getElementById("openDialog")
        const createDialog = document.getElementById("creationDialog")
        const closeDialog = document.getElementById("closeDialog")

        openDialog.addEventListener("click", function (){
            createDialog.showModal();
        })
        closeDialog.addEventListener("click",function (){
            createDialog.close();
        })

        let checkboxes = document.querySelectorAll('input[type="checkbox"][name="tag"]');
        checkboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                let atLeastOneChecked = Array.from(checkboxes).some(function(checkbox) {
                    return checkbox.checked;
                });
                if (!atLeastOneChecked) {
                    document.querySelector('input[type="checkbox"][value="CONSEIL"]').checked = true;
                }
            });
        });

    </script>
    <script th:src="@{/js/script-forum.js}"></script>
</html>